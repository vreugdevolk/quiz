<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bureau Max Quiz</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700;800;900&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --navy: #212c65;
      --navy-dark: #1a2350;
      --navy-light: #2d3a7a;
      --coral: #ee6d4e;
      --coral-light: #f48970;
      --coral-dark: #d85a3c;
      --white: #ffffff;
      --gray-100: #f8f9fc;
      --gray-200: #e8ebf4;
      --gray-300: #c5cce0;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--navy);
      min-height: 100vh;
      color: var(--white);
      overflow: hidden;
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0.03;
      pointer-events: none;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    }

    body::after {
      content: '';
      position: fixed;
      top: -50%;
      right: -30%;
      width: 80%;
      height: 100%;
      background: radial-gradient(ellipse at center, rgba(238, 109, 78, 0.15) 0%, transparent 60%);
      pointer-events: none;
    }

    .container {
      display: flex;
      flex-direction: column;
      height: 100vh;
      padding: 30px 50px;
      position: relative;
      z-index: 1;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 20px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .logo {
      height: 50px;
      width: auto;
    }

    .brand-text {
      display: flex;
      flex-direction: column;
    }

    .brand-title {
      font-family: 'Outfit', sans-serif;
      font-size: 2rem;
      font-weight: 800;
      letter-spacing: -0.02em;
      background: linear-gradient(135deg, var(--white) 0%, var(--gray-200) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .brand-tagline {
      font-size: 0.85rem;
      color: var(--coral);
      font-weight: 500;
      letter-spacing: 0.1em;
      text-transform: uppercase;
    }

    .header-info {
      text-align: right;
    }

    .phase-badge {
      display: inline-block;
      padding: 12px 28px;
      background: var(--coral);
      border-radius: 50px;
      font-family: 'Outfit', sans-serif;
      font-size: 1rem;
      font-weight: 700;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      box-shadow: 0 4px 20px rgba(238, 109, 78, 0.4);
      animation: float 3s ease-in-out infinite;
    }

    .category-badge {
      display: inline-block;
      padding: 12px 28px;
      background: linear-gradient(135deg, var(--coral) 0%, var(--coral-dark) 100%);
      border-radius: 50px;
      font-family: 'Outfit', sans-serif;
      font-size: 1.1rem;
      font-weight: 700;
      letter-spacing: 0.03em;
      box-shadow: 0 4px 20px rgba(238, 109, 78, 0.4);
    }

    .question-info {
      font-size: 0.95rem;
      color: var(--gray-300);
      margin-top: 10px;
      font-weight: 500;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }

    .main-content {
      flex: 1;
      display: flex;
      gap: 40px;
      min-height: 0;
    }

    .question-area {
      flex: 2.5;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .waiting-screen {
      text-align: center;
      animation: fadeUp 0.6s ease-out;
    }

    .waiting-screen h2 {
      font-family: 'Outfit', sans-serif;
      font-size: 4rem;
      font-weight: 900;
      letter-spacing: -0.03em;
      margin-bottom: 20px;
      background: linear-gradient(135deg, var(--white) 0%, var(--gray-200) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .waiting-screen p {
      font-size: 1.4rem;
      color: var(--gray-300);
    }

    .join-url {
      font-family: 'Outfit', sans-serif;
      font-size: 2rem;
      font-weight: 700;
      color: var(--coral);
      margin-top: 40px;
      padding: 25px 50px;
      background: rgba(238, 109, 78, 0.1);
      border: 2px solid rgba(238, 109, 78, 0.3);
      border-radius: 16px;
      display: inline-block;
      letter-spacing: -0.01em;
    }

    .player-count {
      margin-top: 40px;
      font-family: 'Outfit', sans-serif;
      font-size: 1.3rem;
      color: var(--coral);
      font-weight: 600;
    }

    .category-voting-display {
      width: 100%;
      text-align: center;
      animation: fadeUp 0.6s ease-out;
    }

    .category-voting-display h2 {
      font-family: 'Outfit', sans-serif;
      font-size: 2.8rem;
      font-weight: 800;
      letter-spacing: -0.02em;
      color: var(--white);
      margin-bottom: 15px;
    }

    .category-voting-display .instruction {
      font-size: 1.3rem;
      color: var(--coral);
      margin-bottom: 40px;
      font-weight: 500;
    }

    .approved-count-big {
      font-family: 'Outfit', sans-serif;
      font-size: 10rem;
      font-weight: 900;
      color: var(--coral);
      line-height: 1;
      text-shadow: 0 10px 40px rgba(238, 109, 78, 0.3);
    }

    .approved-count-label {
      font-family: 'Outfit', sans-serif;
      font-size: 1.8rem;
      font-weight: 600;
      color: var(--gray-300);
      margin-bottom: 50px;
      letter-spacing: -0.01em;
    }

    .category-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 16px;
      max-height: 350px;
      overflow-y: auto;
      padding: 10px;
    }

    .category-grid::-webkit-scrollbar {
      width: 8px;
    }

    .category-grid::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    .category-grid::-webkit-scrollbar-thumb {
      background: rgba(238, 109, 78, 0.4);
      border-radius: 4px;
    }

    .category-card {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 20px;
      text-align: left;
      transition: all 0.3s ease;
    }

    .category-card:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateY(-2px);
    }

    .category-card.approved {
      background: rgba(238, 109, 78, 0.15);
      border: 2px solid var(--coral);
      animation: approvedPulse 2s infinite;
    }

    @keyframes approvedPulse {
      0%, 100% { box-shadow: 0 0 20px rgba(238, 109, 78, 0.2); }
      50% { box-shadow: 0 0 40px rgba(238, 109, 78, 0.4); }
    }

    .category-card .name {
      font-family: 'Outfit', sans-serif;
      font-size: 1.2rem;
      font-weight: 700;
      margin-bottom: 8px;
      letter-spacing: -0.01em;
    }

    .category-card .suggesters {
      font-size: 0.9rem;
      color: var(--gray-300);
      margin-bottom: 12px;
    }

    .category-card .progress {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .category-card .progress-bar {
      flex: 1;
      height: 6px;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 3px;
      overflow: hidden;
    }

    .category-card .progress-bar .fill {
      height: 100%;
      background: linear-gradient(90deg, var(--coral) 0%, var(--coral-light) 100%);
      transition: width 0.4s ease;
    }

    .category-card .progress-count {
      font-family: 'Outfit', sans-serif;
      font-weight: 700;
      min-width: 45px;
      color: var(--gray-300);
    }

    .category-card.approved .progress-count {
      color: var(--coral);
    }

    .question-card {
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 32px;
      padding: 70px 80px;
      width: 100%;
      text-align: center;
      animation: fadeUp 0.5s ease-out;
    }

    .question-text {
      font-family: 'Outfit', sans-serif;
      font-size: 3.2rem;
      font-weight: 700;
      line-height: 1.3;
      margin-bottom: 50px;
      letter-spacing: -0.02em;
      background: linear-gradient(135deg, var(--white) 0%, var(--gray-200) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .answer-text {
      font-family: 'Outfit', sans-serif;
      font-size: 2.5rem;
      font-weight: 800;
      color: var(--coral);
      padding: 35px 50px;
      background: rgba(238, 109, 78, 0.1);
      border: 2px solid rgba(238, 109, 78, 0.3);
      border-radius: 20px;
      animation: revealAnswer 0.6s ease-out;
    }

    @keyframes revealAnswer {
      0% { opacity: 0; transform: scale(0.9); }
      100% { opacity: 1; transform: scale(1); }
    }

    .answer-hidden {
      font-size: 1.3rem;
      color: var(--gray-300);
      font-style: italic;
      opacity: 0.6;
    }

    .skip-vote-bar {
      margin-top: 35px;
      padding: 18px 30px;
      background: rgba(238, 109, 78, 0.1);
      border: 1px solid rgba(238, 109, 78, 0.25);
      border-radius: 16px;
      width: 100%;
    }

    .skip-vote-bar.active {
      animation: pulse 1.5s infinite;
    }

    .skip-vote-label {
      font-size: 0.9rem;
      color: var(--coral);
      margin-bottom: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .skip-vote-progress {
      display: flex;
      align-items: center;
      gap: 18px;
    }

    .skip-vote-progress .bar {
      flex: 1;
      height: 12px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      overflow: hidden;
    }

    .skip-vote-progress .bar .fill {
      height: 100%;
      background: linear-gradient(90deg, var(--coral) 0%, var(--coral-light) 100%);
      transition: width 0.4s ease;
    }

    .skip-vote-progress .count {
      font-family: 'Outfit', sans-serif;
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--coral);
      min-width: 90px;
      text-align: right;
    }

    .sidebar {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 20px;
      min-width: 320px;
    }

    .players-area {
      flex: 1;
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 24px;
      padding: 25px;
      overflow-y: auto;
    }

    .players-area::-webkit-scrollbar {
      width: 6px;
    }

    .players-area::-webkit-scrollbar-track {
      background: transparent;
    }

    .players-area::-webkit-scrollbar-thumb {
      background: rgba(238, 109, 78, 0.3);
      border-radius: 3px;
    }

    .players-area h3 {
      font-family: 'Outfit', sans-serif;
      font-size: 1rem;
      font-weight: 700;
      margin-bottom: 18px;
      color: var(--gray-300);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      text-align: center;
    }

    .player-list {
      list-style: none;
    }

    .player-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 16px;
      margin-bottom: 8px;
      background: rgba(255, 255, 255, 0.04);
      border-radius: 12px;
      font-size: 1rem;
      transition: all 0.2s ease;
    }

    .player-item:hover {
      background: rgba(255, 255, 255, 0.07);
    }

    .player-item.has-bet {
      border: 2px solid var(--coral);
      background: rgba(238, 109, 78, 0.1);
    }

    .player-name {
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .bet-icon {
      font-family: 'Outfit', sans-serif;
      color: var(--coral);
      font-size: 0.8rem;
      font-weight: 800;
      padding: 2px 6px;
      background: rgba(238, 109, 78, 0.2);
      border-radius: 4px;
    }

    .player-score {
      font-family: 'Outfit', sans-serif;
      color: var(--coral);
      font-weight: 700;
      font-size: 1.1rem;
    }

    .player-status {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .player-answered {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
    }

    .player-answered.submitted {
      background: var(--coral);
      box-shadow: 0 0 10px var(--coral);
      animation: pulse 1.5s infinite;
    }

    .player-skip-vote {
      font-size: 0.7rem;
      font-weight: 700;
      color: var(--coral);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .categories-overview {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 20px;
      padding: 22px;
    }

    .categories-overview h3 {
      font-family: 'Outfit', sans-serif;
      font-size: 0.9rem;
      font-weight: 700;
      margin-bottom: 15px;
      color: var(--gray-300);
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .category-dots {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .category-dot {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Outfit', sans-serif;
      font-size: 0.85rem;
      font-weight: 700;
      transition: all 0.3s ease;
    }

    .category-dot.current {
      background: var(--coral);
      color: var(--white);
      box-shadow: 0 4px 15px rgba(238, 109, 78, 0.4);
      transform: scale(1.1);
    }

    .category-dot.completed {
      background: rgba(238, 109, 78, 0.3);
      color: var(--coral);
    }

    .finished-screen {
      text-align: center;
      animation: fadeUp 0.6s ease-out;
    }

    .finished-screen h2 {
      font-family: 'Outfit', sans-serif;
      font-size: 4.5rem;
      font-weight: 900;
      margin-bottom: 60px;
      color: var(--coral);
      letter-spacing: -0.03em;
    }

    .final-scores {
      display: flex;
      justify-content: center;
      gap: 30px;
      flex-wrap: wrap;
      align-items: flex-end;
    }

    .score-card {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 35px 50px;
      border-radius: 24px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .score-card.first {
      background: linear-gradient(135deg, var(--coral) 0%, var(--coral-dark) 100%);
      color: var(--white);
      transform: scale(1.15);
      box-shadow: 0 20px 60px rgba(238, 109, 78, 0.4);
    }

    .score-card .rank {
      font-family: 'Outfit', sans-serif;
      font-size: 2.5rem;
      font-weight: 900;
      margin-bottom: 10px;
      opacity: 0.6;
    }

    .score-card.first .rank {
      opacity: 1;
    }

    .score-card .name {
      font-family: 'Outfit', sans-serif;
      font-size: 1.5rem;
      font-weight: 700;
      letter-spacing: -0.01em;
    }

    .score-card .points {
      font-family: 'Outfit', sans-serif;
      font-size: 2.8rem;
      font-weight: 900;
      margin-top: 15px;
      color: var(--coral);
    }

    .score-card.first .points {
      color: var(--white);
    }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    .footer-brand {
      position: fixed;
      bottom: 25px;
      left: 50px;
      font-size: 0.85rem;
      color: var(--gray-300);
      opacity: 0.5;
      font-weight: 500;
    }

    .footer-brand span {
      color: var(--coral);
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <img src="/bureau_max_logo_wit.png" alt="Bureau Max" class="logo">
        <div class="brand-text">
          <div class="brand-title">Quiz Night</div>
          <div class="brand-tagline">Digital Storytellers</div>
        </div>
      </div>
      <div class="header-info">
        <div id="phaseBadge"></div>
        <div class="question-info" id="questionInfo"></div>
      </div>
    </header>

    <div class="main-content">
      <div class="question-area" id="questionArea"></div>

      <div class="sidebar">
        <div class="players-area">
          <h3>Spelers</h3>
          <ul class="player-list" id="playerList"></ul>
        </div>

        <div class="categories-overview" id="categoriesOverview">
          <h3>Categorieën</h3>
          <div class="category-dots" id="categoryDots"></div>
        </div>
      </div>
    </div>
  </div>

  <div class="footer-brand">
    Powered by <span>Bureau Max</span>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();
    let currentState = null;
    let players = [];
    let categories = [];
    let skipVoteStatus = { skipVoteCount: 0, totalPlayers: 0, votesNeeded: 1 };

    // Helper to safely set text content
    function setText(el, text) {
      if (el) el.textContent = text;
    }

    // Helper to create element with text
    function createEl(tag, className, text) {
      const el = document.createElement(tag);
      if (className) el.className = className;
      if (text) el.textContent = text;
      return el;
    }

    socket.on('gameState', (state) => {
      currentState = state;
      render();
    });

    socket.on('playerUpdate', (playerData) => {
      players = playerData;
      renderPlayers();
    });

    socket.on('categoryVotesUpdate', (cats) => {
      categories = cats;
      if (currentState?.phase === 'category-voting') {
        render();
      }
    });

    socket.on('skipVoteUpdate', (status) => {
      skipVoteStatus = status;
      if (currentState?.phase === 'playing') {
        render();
      }
    });

    function render() {
      const questionArea = document.getElementById('questionArea');
      const phaseBadge = document.getElementById('phaseBadge');
      const questionInfo = document.getElementById('questionInfo');
      const categoriesOverview = document.getElementById('categoriesOverview');

      if (!currentState) {
        questionArea.textContent = '';
        const waiting = createEl('div', 'waiting-screen');
        waiting.appendChild(createEl('h2', null, 'Verbinden...'));
        questionArea.appendChild(waiting);
        return;
      }

      if (currentState.phase === 'lobby') {
        phaseBadge.textContent = '';
        questionInfo.textContent = '';
        categoriesOverview.style.display = 'none';
        renderLobby();
      } else if (currentState.phase === 'category-voting') {
        phaseBadge.textContent = '';
        const badge = createEl('div', 'phase-badge', 'Categorieën Kiezen');
        phaseBadge.appendChild(badge);
        questionInfo.textContent = '';
        categoriesOverview.style.display = 'none';
        renderCategoryVoting();
      } else if (currentState.phase === 'playing') {
        phaseBadge.textContent = '';
        const badge = createEl('div', 'category-badge', currentState.currentCategory?.name || '');
        phaseBadge.appendChild(badge);
        categoriesOverview.style.display = 'block';
        renderPlaying();
      } else if (currentState.phase === 'finished') {
        phaseBadge.textContent = '';
        questionInfo.textContent = '';
        categoriesOverview.style.display = 'block';
        renderFinished();
      }
    }

    function renderLobby() {
      const questionArea = document.getElementById('questionArea');
      questionArea.textContent = '';

      const screen = createEl('div', 'waiting-screen');
      screen.appendChild(createEl('h2', null, 'Welkom!'));
      screen.appendChild(createEl('p', null, 'Doe mee op je telefoon:'));

      const url = createEl('div', 'join-url', window.location.origin + '/quiz/jouwnaam');
      screen.appendChild(url);

      const count = createEl('div', 'player-count', players.length + ' spelers aangemeld');
      screen.appendChild(count);

      questionArea.appendChild(screen);
    }

    function renderCategoryVoting() {
      const questionArea = document.getElementById('questionArea');
      questionArea.textContent = '';

      const approvedCount = categories.filter(c => c.isApproved).length;

      const container = createEl('div', 'category-voting-display');
      container.appendChild(createEl('h2', null, 'Welke categorieën willen jullie?'));

      const instruction = createEl('div', 'instruction', 'Typ een categorie op je telefoon — 3× dezelfde = toegevoegd!');
      container.appendChild(instruction);

      container.appendChild(createEl('div', 'approved-count-big', String(approvedCount)));
      container.appendChild(createEl('div', 'approved-count-label', 'categorieën goedgekeurd'));

      const grid = createEl('div', 'category-grid');

      if (categories.length === 0) {
        grid.appendChild(createEl('p', null, 'Wachten op suggesties...'));
        grid.firstChild.style.color = 'var(--gray-300)';
        grid.firstChild.style.fontSize = '1.3rem';
      } else {
        categories.forEach(cat => {
          const card = createEl('div', 'category-card' + (cat.isApproved ? ' approved' : ''));
          card.appendChild(createEl('div', 'name', cat.name));
          card.appendChild(createEl('div', 'suggesters', cat.suggesters.join(', ')));

          const progress = createEl('div', 'progress');
          const progressBar = createEl('div', 'progress-bar');
          const fill = createEl('div', 'fill');
          const percentage = (cat.suggesterCount / currentState.votesNeededForCategory) * 100;
          fill.style.width = Math.min(percentage, 100) + '%';
          progressBar.appendChild(fill);
          progress.appendChild(progressBar);
          progress.appendChild(createEl('span', 'progress-count', cat.suggesterCount + '/' + currentState.votesNeededForCategory));
          card.appendChild(progress);

          grid.appendChild(card);
        });
      }

      container.appendChild(grid);
      questionArea.appendChild(container);
    }

    function renderPlaying() {
      const questionArea = document.getElementById('questionArea');
      const questionInfo = document.getElementById('questionInfo');
      questionArea.textContent = '';

      renderCategoryDots();

      if (!currentState.currentQuestion) {
        questionInfo.textContent = '';
        const screen = createEl('div', 'waiting-screen');
        screen.appendChild(createEl('h2', null, 'Quiz Afgelopen!'));
        questionArea.appendChild(screen);
        return;
      }

      questionInfo.textContent = 'Vraag ' + (currentState.currentQuestionIndex + 1) + ' van ' + currentState.currentCategory.questionCount + ' · Categorie ' + (currentState.currentCategoryIndex + 1) + ' van ' + currentState.totalCategories;

      const card = createEl('div', 'question-card');
      card.appendChild(createEl('div', 'question-text', currentState.currentQuestion.question));

      if (currentState.showAnswer && currentState.currentQuestion.answer) {
        card.appendChild(createEl('div', 'answer-text', currentState.currentQuestion.answer));
      } else {
        card.appendChild(createEl('div', 'answer-hidden', 'Antwoord verborgen'));
      }

      questionArea.appendChild(card);

      // Skip vote bar
      if (skipVoteStatus.totalPlayers > 0) {
        const skipBar = createEl('div', 'skip-vote-bar' + (skipVoteStatus.skipVoteCount > 0 ? ' active' : ''));
        skipBar.appendChild(createEl('div', 'skip-vote-label', 'Skip Categorie Stemmen'));

        const progress = createEl('div', 'skip-vote-progress');
        const bar = createEl('div', 'bar');
        const fill = createEl('div', 'fill');
        const percentage = (skipVoteStatus.skipVoteCount / skipVoteStatus.votesNeeded) * 100;
        fill.style.width = Math.min(percentage, 100) + '%';
        bar.appendChild(fill);
        progress.appendChild(bar);
        progress.appendChild(createEl('div', 'count', skipVoteStatus.skipVoteCount + ' / ' + skipVoteStatus.votesNeeded));

        skipBar.appendChild(progress);
        questionArea.appendChild(skipBar);
      }
    }

    function renderCategoryDots() {
      const dots = document.getElementById('categoryDots');
      dots.textContent = '';

      if (!currentState || currentState.totalCategories === 0) return;

      for (let i = 0; i < currentState.totalCategories; i++) {
        let className = 'category-dot';
        if (i < currentState.currentCategoryIndex) {
          className += ' completed';
        } else if (i === currentState.currentCategoryIndex) {
          className += ' current';
        }
        dots.appendChild(createEl('div', className, String(i + 1)));
      }
    }

    function renderFinished() {
      const questionArea = document.getElementById('questionArea');
      questionArea.textContent = '';

      const sortedPlayers = [...players].sort((a, b) => b.score - a.score);

      const screen = createEl('div', 'finished-screen');
      screen.appendChild(createEl('h2', null, 'Quiz Afgelopen!'));

      const scores = createEl('div', 'final-scores');

      sortedPlayers.slice(0, 5).forEach((player, index) => {
        const card = createEl('div', 'score-card' + (index === 0 ? ' first' : ''));
        card.appendChild(createEl('div', 'rank', '#' + (index + 1)));
        card.appendChild(createEl('div', 'name', player.name));
        card.appendChild(createEl('div', 'points', player.score + ' pts'));
        scores.appendChild(card);
      });

      screen.appendChild(scores);
      questionArea.appendChild(screen);
    }

    function renderPlayers() {
      const playerList = document.getElementById('playerList');
      playerList.textContent = '';

      players.forEach(player => {
        const hasAnswered = player.currentAnswer !== undefined && player.currentAnswer !== null;

        const li = createEl('li', 'player-item' + (player.hasBetOnCurrent ? ' has-bet' : ''));

        const nameSpan = createEl('span', 'player-name');
        if (player.hasBetOnCurrent) {
          nameSpan.appendChild(createEl('span', 'bet-icon', '2×'));
        }
        nameSpan.appendChild(document.createTextNode(player.name));
        li.appendChild(nameSpan);

        const status = createEl('span', 'player-status');
        if (player.hasVotedSkip) {
          status.appendChild(createEl('span', 'player-skip-vote', 'SKIP'));
        }
        status.appendChild(createEl('span', 'player-score', String(player.score)));
        status.appendChild(createEl('span', 'player-answered' + (hasAnswered ? ' submitted' : '')));
        li.appendChild(status);

        playerList.appendChild(li);
      });
    }

    render();
  </script>
</body>
</html>
